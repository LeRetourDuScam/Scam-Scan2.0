<div class="py-10">
  <div class="container mx-auto px-4 sm:px-6 lg:px-8 justify-center">
    <h2 class="text-2xl sm:text-3xl lg:text-4xl font-bold text-center mb-6 text-red-600 dark:text-red-400">
      All Mangas
    </h2>

    <div class="w-full">
      <div class="flex justify-center">
        <button 
        (click)="toggleExpandable()" 
        class="w-2/3 bg-red-500 text-white rounded-lg px-4 py-2 hover:bg-red-600 focus:outline-none focus:ring-2 focus:ring-red-600"
      >
        {{ isExpanded ? 'Hide Filters' : 'Show Filters' }}
      </button>
    </div>

    <div *ngIf="isExpanded" class="flex justify-center flex-wrap">
      <div class="w-2/3 flex items-center pt-3">
        <input 
          type="text" 
          placeholder="Author" 
          (keyup)="handleChange($event,'author',authorControl)" 
          [formControl]="authorControl" 
          class="flex-grow border border-gray-300 rounded-lg shadow-sm px-4 py-2 bg-white text-gray-700 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-red-600 focus:border-transparent dark:bg-gray-700 dark:text-white dark:border-gray-600 dark:placeholder-gray-500"
        />
        <button 
          aria-label="Clear" 
          (click)="cleanParam('author',authorControl)" 
          *ngIf="this.MangaParams.author" 
          class="bg-red-500 text-white rounded-lg px-4 py-2 hover:bg-red-600 focus:outline-none focus:ring-2 focus:ring-red-600"
        >
          Clear
        </button>
      </div>


      <div class="w-2/3 flex items-center pt-3">
        <input 
          type="text" 
          placeholder="Rating" 
          (keyup)="handleChange($event,'rating',ratingControl)" 
          [formControl]="ratingControl" 
          class="flex-grow border border-gray-300 rounded-lg shadow-sm px-4 py-2 bg-white text-gray-700 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-red-600 focus:border-transparent dark:bg-gray-700 dark:text-white dark:border-gray-600 dark:placeholder-gray-500"
        />
        <button 
          aria-label="Clear" 
          (click)="cleanParam('rating',ratingControl)" 
          *ngIf="this.MangaParams.rating" 
          class="bg-red-500 text-white rounded-lg px-4 py-2 hover:bg-red-600 focus:outline-none focus:ring-2 focus:ring-red-600"
        >
          Clear
        </button>
      </div>

      <div class="w-2/3 flex items-center pt-3">
        <select 
        id="status-select"
          [formControl]="statusControl" 
          (change)="handleChange($event,'status',statusControl)" 
          class="flex-grow border border-gray-300 rounded-lg shadow-sm px-4 py-2 bg-white text-gray-700 focus:outline-none focus:ring-2 focus:ring-red-600 dark:bg-gray-700 dark:text-white dark:border-gray-600"
        >
         <option disabled>Select Status</option>
          <option *ngFor="let status of StatusEnum" [value]="status">{{ status }}</option>
        </select>
        <button 
          aria-label="Clear" 
          (click)="cleanParam('status',statusControl)" 
          *ngIf="this.MangaParams.status" 
          class="bg-red-500 text-white rounded-lg px-4 py-2 hover:bg-red-600 focus:outline-none focus:ring-2 focus:ring-red-600"
        >
          Clear
        </button>
      </div>

      <div class="w-2/3 flex items-center pt-3">
        <select 
        id="years-select"
          [formControl]="publicationYearControl" 
          (change)="handleChange($event,'publicationYear',publicationYearControl)" 
          class="flex-grow border border-gray-300 rounded-lg shadow-sm px-4 py-2 bg-white text-gray-700 focus:outline-none focus:ring-2 focus:ring-red-600 dark:bg-gray-700 dark:text-white dark:border-gray-600"
        >
        <option disabled>Select Year</option>
          <option *ngFor="let publicationYear of years" [value]="publicationYear">{{ publicationYear }}</option>
        </select>
        <button 
          aria-label="Clear" 
          (click)="cleanParam('publicationYear',publicationYearControl)" 
          *ngIf="this.MangaParams.publicationYear" 
          class="bg-red-500 text-white rounded-lg px-4 py-2 hover:bg-red-600 focus:outline-none focus:ring-2 focus:ring-red-600"
        >
          Clear
        </button>
      </div>

      <div class="w-2/3 flex items-center pt-3">
        <select 
          [formControl]="typeControl" 
          (change)="handleChange($event,'type',typeControl)" 
          class="flex-grow border border-gray-300 rounded-lg shadow-sm px-4 py-2 bg-white text-gray-700 focus:outline-none focus:ring-2 focus:ring-red-600 dark:bg-gray-700 dark:text-white dark:border-gray-600"
        >
        <option disabled>Select Type</option>
          <option *ngFor="let type of TypesEnum" [value]="type">{{ type }}</option>
        </select>
        <button 
          aria-label="Clear" 
          (click)="cleanParam('type',typeControl)" 
          *ngIf="this.MangaParams.type" 
          class="bg-red-500 text-white rounded-lg px-4 py-2 hover:bg-red-600 focus:outline-none focus:ring-2 focus:ring-red-600"
        >
          Clear
        </button>
      </div>

      <div class="w-2/3 flex items-center pt-3">
        <select 
          [formControl]="genreControl" 
          (change)="handleChange($event,'genre',genreControl)" 
          class="flex-grow border border-gray-300 rounded-lg shadow-sm px-4 py-2 bg-white text-gray-700 focus:outline-none focus:ring-2 focus:ring-red-600 dark:bg-gray-700 dark:text-white dark:border-gray-600"
        >
        <option disabled>Select Genre</option>
          <option *ngFor="let genre of GenresEnum" [value]="genre">{{ genre }}</option>
        </select>
        <button 
          aria-label="Clear" 
          (click)="cleanParam('genre',genreControl)" 
          *ngIf="this.MangaParams.genre" 
          class="bg-red-500 text-white rounded-lg px-4 py-2 hover:bg-red-600 focus:outline-none focus:ring-2 focus:ring-red-600"
        >
          Clear
        </button>
      </div>

      <div class="w-2/3 flex items-center pt-3">
        <select 
          [formControl]="languageControl" 
          (change)="handleChange($event,'language',languageControl)" 
          class="flex-grow border border-gray-300 rounded-lg shadow-sm px-4 py-2 bg-white text-gray-700 focus:outline-none focus:ring-2 focus:ring-red-600 dark:bg-gray-700 dark:text-white dark:border-gray-600"
        >
        <option disabled>Select Language</option>
          <option *ngFor="let language of LanguagesEnum" [value]="language">{{ language }}</option>
        </select>
        <button 
          aria-label="Clear" 
          (click)="cleanParam('language',languageControl)" 
          *ngIf="this.MangaParams.language" 
          class="bg-red-500 text-white rounded-lg px-4 py-2 hover:bg-red-600 focus:outline-none focus:ring-2 focus:ring-red-600"
        >
          Clear
        </button>
      </div>
    </div>

    <section class="mt-8">
      <div class="grid grid-cols-1 sm:grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
        <div 
          class="bg-white dark:bg-gray-800 dark:text-white rounded-lg shadow-lg p-4 sm:p-6 lg:p-8 hover:cursor-pointer" 
          *ngFor="let manga of mangas" 
          [routerLink]="['/manga/view', manga.slug]"
        >
          <div class="mb-4">
            <h3 class="text-lg sm:text-xl lg:text-2xl font-bold">{{ manga.name }}</h3>
          </div>
          <img 
            [src]="manga.image" 
            alt="{{ manga.name }}" 
            class="w-2/3 h-48 sm:h-56 lg:h-64 object-cover rounded-lg mb-4" 
          />
          <div>
            <div *ngFor="let chapter of getLastChapters(manga)">
              <div 
                [routerLink]="['/manga/view', manga.slug, 'chapter', chapter.slug]" 
                class="text-red-600 dark:text-red-400 hover:underline text-sm sm:text-base lg:text-lg"
              >
                {{ chapter.name }} ajouté : {{ chapter.updated_at | date }}
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
    <div class="flex justify-center mt-8 space-x-4">
      <button 
        (click)="previousPage()" 
        [disabled]="!hasPreviousPage()" 
        class="px-4 py-2 bg-gray-300 dark:bg-gray-700 dark:text-white text-gray-700 rounded hover:bg-gray-400 dark:hover:bg-gray-600 disabled:opacity-50 disabled:cursor-not-allowed"
      >
        Page Précédent
      </button>
      <button 
        (click)="nextPage()" 
        [disabled]="!hasNextPage()" 
        class="px-4 py-2 bg-gray-300 dark:bg-gray-700 dark:text-white text-gray-700 rounded hover:bg-gray-400 dark:hover:bg-gray-600 disabled:opacity-50 disabled:cursor-not-allowed"
      >
        Page Suivant
      </button>
    </div>
  </div>
</div>